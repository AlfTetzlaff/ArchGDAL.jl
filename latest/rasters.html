<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Raster Data · ArchGDAL.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ArchGDAL.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">ArchGDAL.jl documentation</a></li><li><a class="toctext" href="datasets.html">GDAL Datasets</a></li><li><a class="toctext" href="features.html">Feature Data</a></li><li class="current"><a class="toctext" href="rasters.html">Raster Data</a><ul class="internal"><li><a class="toctext" href="#Raster-Bands-1">Raster Bands</a></li><li><a class="toctext" href="#Raster-I/O-1">Raster I/O</a></li><li><a class="toctext" href="#Windowed-Reads-and-Writes-1">Windowed Reads and Writes</a></li></ul></li><li><a class="toctext" href="geometries.html">Geometric Operations</a></li><li><a class="toctext" href="projections.html">Spatial Projections</a></li><li><a class="toctext" href="memory.html">Memory Management</a></li><li><a class="toctext" href="spatialite.html">Working with Spatialite</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="rasters.html">Raster Data</a></li></ul><a class="edit-page" href="https://github.com/yeesian/ArchGDAL.jl/blob/master/docs/src/rasters.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Raster Data</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Raster-Data-1" href="#Raster-Data-1">Raster Data</a></h1><p>In this section, we revisit the <a href="https://github.com/yeesian/ArchGDALDatasets/blob/307f8f0e584a39a050c042849004e6a2bd674f99/gdalworkshop/world.tif"><code>gdalworkshop/world.tif</code></a> dataset.</p><div></div><div><pre><code class="language-julia">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filepath) do dataset
        print(dataset)
    end
end</code></pre><pre><code class="language-none">GDAL Dataset (Driver: GTiff/GeoTIFF)
File(s):
  world.tif

Dataset (width x height): 2048 x 1024 (pixels)
Number of raster bands: 3
  [GA_ReadOnly] Band 1 (Red): 2048 x 1024 (UInt8)
  [GA_ReadOnly] Band 2 (Green): 2048 x 1024 (UInt8)
  [GA_ReadOnly] Band 3 (Blue): 2048 x 1024 (UInt8)</code></pre></div><p>A description of the display is available in <a href="datasets.html#Raster-Datasets-1">Raster Datasets</a>.</p><h2><a class="nav-anchor" id="Raster-Bands-1" href="#Raster-Bands-1">Raster Bands</a></h2><p>We can examine an individual raster band</p><div><pre><code class="language-julia">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filepath) do dataset
        band = ArchGDAL.getband(dataset, 1)
        print(band)
    end
end</code></pre><pre><code class="language-none">[GA_ReadOnly] Band 1 (Red): 2048 x 1024 (UInt8)
    blocksize: 256×256, nodata: -1.0e10, units: 1.0px + 0.0
    overviews: (0) 1024x512 (1) 512x256 (2) 256x128
               (3) 128x64 (4) 64x32 (5) 32x16
               (6) 16x8</code></pre></div><p>You can programmatically retrieve the information in the header using</p><ul><li><p><code>ArchGDAL.getaccess(band)</code>: whether we have update permission for this band. (<code>GA_ReadOnly</code>)</p></li><li><p><code>colorinterp = ArchGDAL.getcolorinterp(band)</code>: color interpretation of the values in the band (<code>GCI_RedBand</code>)</p></li><li><p><code>ArchGDAL.getname(colorinterp)</code>: name (string) corresponding to color interpretation (<code>&quot;Red&quot;</code>)</p></li><li><p><code>ArchGDAL.width(band)</code>: width (pixels) of the band (<code>2048</code>)</p></li><li><p><code>ArchGDAL.height(band)</code>: height (pixels) of the band (<code>1024</code>)</p></li><li><p><code>ArchGDAL.getnumber(band)</code>: the band number (1+) within its dataset, or 0 if unknown. (<code>1</code>)</p></li><li><p><code>ArchGDAL.getdatatype(band)</code>: pixel data type for this band. (<code>UInt8</code>)</p></li></ul><p>You can get additional attribute information using</p><ul><li><p><code>ArchGDAL.getscale(band)</code>: the scale in <code>units = (px * scale) + offset</code> (<code>1.0</code>)</p></li><li><p><code>ArchGDAL.getoffset(band)</code>: the offset in <code>units = (px * scale) + offset</code> (<code>0.0</code>)</p></li><li><p><code>ArchGDAL.getunittype(band)</code>: name for the units, e.g. &quot;m&quot; (meters) or &quot;ft&quot; (feet). (<code>&quot;&quot;</code>)</p></li><li><p><code>ArchGDAL.getnodatavalue(band)</code>: a special marker value used to mark pixels that are not valid data. (<code>-1.0e10</code>)</p></li><li><p><code>(x,y) = ArchGDAL.getblocksize(band)</code>: the &quot;natural&quot; block size of this band (<code>(256,256)</code>)</p></li></ul><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>GDAL contains a concept of the natural block size of rasters so that applications can organized data access efficiently for some file formats. The natural block size is the block size that is most efficient for accessing the format. For many formats this is simple a whole scanline in which case <code>*pnXSize</code> is set to <code>GetXSize()</code>, and <code>*pnYSize</code> is set to <code>1</code>.</p><p>However, for tiled images this will typically be the tile size.</p><p>Note that the <code>X</code> and <code>Y</code> block sizes don&#39;t have to divide the image size evenly, meaning that right and bottom edge blocks may be incomplete.</p></div></div><p>Finally, you can obtain overviews:</p><ul><li><p><code>ArchGDAL.noverview(band)</code>: the number of overview layers available, zero if none. (<code>7</code>)</p></li><li><p><code>ArchGDAL.getoverview(band, i)</code>: returns the <code>i</code>-th overview in the raster band. Each overview is itself a raster band.</p></li></ul><h2><a class="nav-anchor" id="Raster-I/O-1" href="#Raster-I/O-1">Raster I/O</a></h2><h3><a class="nav-anchor" id="Reading-Raster-Values-1" href="#Reading-Raster-Values-1">Reading Raster Values</a></h3><p>The general operative method for reading in raster values from a <code>dataset</code> or <code>band</code> is to use <code>ArchGDAL.read()</code>.</p><ul><li><p><code>ArchGDAL.read(dataset)</code>: reads the entire dataset as a single multidimensional array.</p></li><li><p><code>ArchGDAL.read(dataset, indices)</code>: reads the raster bands at the <code>indices</code> (in that order) into a multidimensional array.</p></li><li><p><code>ArchGDAL.read(dataset, i)</code>: reads the <code>i</code>-th raster band into an array.</p></li><li><p><code>ArchGDAL.read(band)</code>: reads the raster band into an array.</p></li></ul><p>You can also specify the subset of rows and columns (provided as <code>UnitRange</code>s) to read:</p><ul><li><p><code>ArchGDAL.read(dataset, indices, rows, cols)</code></p></li><li><p><code>ArchGDAL.read(dataset, i, rows, cols)</code></p></li><li><p><code>ArchGDAL.read(band, rows, cols)</code></p></li></ul><p>On other occasions, it might be easier to first specify a position <code>(xoffset,yoffset)</code> to read from, and the size <code>(xsize, ysize)</code> of the window to read:</p><ul><li><p><code>ArchGDAL.read(dataset, indices, xoffset, yoffset, xsize, ysize)</code></p></li><li><p><code>ArchGDAL.read(dataset, i, xoffset, yoffset, xsize, ysize)</code></p></li><li><p><code>ArchGDAL.read(band, xoffset, yoffset, xsize, ysize)</code></p></li></ul><p>You might have an existing buffer that you wish to read the values into. In such cases, the general API for doing so is to write <code>ArchGDAL.read!(source, buffer, args...)</code> instead of <code>ArchGDAL.read(source, args...)</code>.</p><h3><a class="nav-anchor" id="Writing-Raster-Values-1" href="#Writing-Raster-Values-1">Writing Raster Values</a></h3><p>For writing values from a <code>buffer</code> to a raster <code>dataset</code> or <code>band</code>, the following methods are available:</p><ul><li><p><code>ArchGDAL.write!(band, buffer)</code></p></li><li><p><code>ArchGDAL.write!(band, buffer, rows, cols)</code></p></li><li><p><code>ArchGDAL.write!(band, buffer, xoffset, yoffset, xsize, ysize)</code></p></li><li><p><code>ArchGDAL.write!(dataset, buffer, i)</code></p></li><li><p><code>ArchGDAL.write!(dataset, buffer, i, rows, cols)</code></p></li><li><p><code>ArchGDAL.write!(dataset, buffer, i, xoffset, yoffset, xsize, ysize)</code></p></li><li><p><code>ArchGDAL.write!(dataset, buffer, indices)</code></p></li><li><p><code>ArchGDAL.write!(dataset, buffer, indices, rows, cols)</code></p></li><li><p><code>ArchGDAL.write!(dataset, buffer, indices, xoffset, yoffset, xsize, ysize)</code></p></li></ul><h2><a class="nav-anchor" id="Windowed-Reads-and-Writes-1" href="#Windowed-Reads-and-Writes-1">Windowed Reads and Writes</a></h2><p>Following the description in <a href="https://rasterio.readthedocs.io/en/latest/topics/windowed-rw.html">mapbox/rasterio&#39;s documentation</a>, a window is a view onto a rectangular subset of a raster dataset. This is useful when you want to work on rasters that are larger than your computers RAM or process chunks of large rasters in parallel.</p><p>For that purpose, we have a method called <code>ArchGDAL.windows(band)</code> which iterates over the windows of a raster band, returning the indices corresponding to the rasterblocks within that raster band for efficiency:</p><div><pre><code class="language-julia">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filepath) do dataset
        band = ArchGDAL.getband(dataset, 1)
        for (cols,rows) in ArchGDAL.windows(band)
            println((cols,rows))
        end
    end
end</code></pre><pre><code class="language-none">(1:256, 1:256)
(1:256, 257:512)
(1:256, 513:768)
(1:256, 769:1024)
(257:512, 1:256)
(257:512, 257:512)
(257:512, 513:768)
(257:512, 769:1024)
(513:768, 1:256)
(513:768, 257:512)
(513:768, 513:768)
(513:768, 769:1024)
(769:1024, 1:256)
(769:1024, 257:512)
(769:1024, 513:768)
(769:1024, 769:1024)
(1025:1280, 1:256)
(1025:1280, 257:512)
(1025:1280, 513:768)
(1025:1280, 769:1024)
(1281:1536, 1:256)
(1281:1536, 257:512)
(1281:1536, 513:768)
(1281:1536, 769:1024)
(1537:1792, 1:256)
(1537:1792, 257:512)
(1537:1792, 513:768)
(1537:1792, 769:1024)
(1793:2048, 1:256)
(1793:2048, 257:512)
(1793:2048, 513:768)
(1793:2048, 769:1024)</code></pre></div><p>Alternatively, we have another method called <code>ArchGDAL.blocks(band)</code> which iterates over the windows of a raster band, returning the <code>offset</code> and <code>size</code> corresponding to the rasterblocks within that raster band for efficiency:</p><div><pre><code class="language-julia">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filepath) do dataset
        band = ArchGDAL.getband(dataset, 1)
        for (xyoffset,xysize) in ArchGDAL.blocks(band)
            println((xyoffset,xysize))
        end
    end
end</code></pre><pre><code class="language-none">((0, 0), (256, 256))
((1, 0), (256, 256))
((2, 0), (256, 256))
((3, 0), (256, 256))
((0, 1), (256, 256))
((1, 1), (256, 256))
((2, 1), (256, 256))
((3, 1), (256, 256))
((0, 2), (256, 256))
((1, 2), (256, 256))
((2, 2), (256, 256))
((3, 2), (256, 256))
((0, 3), (256, 256))
((1, 3), (256, 256))
((2, 3), (256, 256))
((3, 3), (256, 256))
((0, 4), (256, 256))
((1, 4), (256, 256))
((2, 4), (256, 256))
((3, 4), (256, 256))
((0, 5), (256, 256))
((1, 5), (256, 256))
((2, 5), (256, 256))
((3, 5), (256, 256))
((0, 6), (256, 256))
((1, 6), (256, 256))
((2, 6), (256, 256))
((3, 6), (256, 256))
((0, 7), (256, 256))
((1, 7), (256, 256))
((2, 7), (256, 256))
((3, 7), (256, 256))</code></pre></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>These methods are often used for reading/writing a block of image data efficiently, as it accesses &quot;natural&quot; blocks from the raster band without resampling, or data type conversion.</p></div></div><footer><hr/><a class="previous" href="features.html"><span class="direction">Previous</span><span class="title">Feature Data</span></a><a class="next" href="geometries.html"><span class="direction">Next</span><span class="title">Geometric Operations</span></a></footer></article></body></html>
